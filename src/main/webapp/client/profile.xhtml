<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">

    <body>

        <ui:composition template="./../template.xhtml">

            <ui:define name="content">


                <h:panelGroup rendered="true" >


                    <h:outputStylesheet library="css" name="all.min.css"></h:outputStylesheet>
                    <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css"></link>

                    <h:outputStylesheet library="css" name="adminlte.min.css"></h:outputStylesheet> 
                    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700" rel="stylesheet"></link>

                    <h:outputScript library="js" name="jquery.min.js"></h:outputScript>
                    <h:outputScript library="js" name="bootstrap.bundle.min.js"></h:outputScript>
                    <h:outputScript library="js" name="adminlte.min.js"></h:outputScript>
                    <h:outputScript library="js" name="demo.js"></h:outputScript>

                    <div class="content-wrapper" style="margin: 0px;">
                        <!-- Content Header (Page header) -->
                        <section class="content-header">
                            <div class="container-fluid">
                                <div class="row mb-2">
                                    <div class="col-sm-6">
                                        <h1>Profile</h1>
                                    </div>
                                    <div class="col-sm-6">
                                        <ol class="breadcrumb float-sm-right">
                                            <li class="breadcrumb-item"><a href="#">Home</a></li>
                                            <li class="breadcrumb-item active">User Profile</li>
                                        </ol>
                                    </div>
                                </div>
                            </div><!-- /.container-fluid -->
                        </section>

                        <!-- Main content -->
                        <section class="content">
                            <div class="container-fluid">
                                <div class="row">
                                    <div class="col-md-3">

                                        <!-- Profile Image -->
                                        <div class="card card-primary card-outline">
                                            <div class="card-body box-profile">
                                                <div class="text-center">



                                                    <p:graphicImage  rendered="#{clientController.selected.person.sex.name eq 'Male'}"
                                                                     library="image" name="male.jpg" 
                                                                     class="profile-user-img img-fluid img-circle"
                                                                     style="width: 128px;  margin: auto;" ></p:graphicImage>

                                                    <p:graphicImage  rendered="#{clientController.selected.person.sex.name eq 'Female'}"
                                                                     class="profile-user-img img-fluid img-circle"
                                                                     library="image" name="female.png" style="width: 128px;  margin: auto;" ></p:graphicImage>



                                                </div>

                                                <h3 class="profile-username text-center">
                                                    <h:outputLabel value="#{clientController.selected.person.nameWithTitle}" ></h:outputLabel>
                                                </h3>

                                                <p class="text-muted text-center">
                                                    <h:outputLabel value="#{clientController.selected.person.gnArea.name}" ></h:outputLabel>
                                                </p>


                                            </div>
                                            <!-- /.card-body -->
                                        </div>
                                        <!-- /.card -->

                                        <!-- About Me Box -->
                                        <div class="card card-primary">
                                            <div class="card-header">
                                                <h3 class="card-title">Demographic Details</h3>
                                            </div>
                                            <!-- /.card-header -->
                                            <div class="card-body">
                                                <strong><i class="fas fa-id-badge mr-1"></i> Name :</strong>


                                                <h:outputLabel value="#{clientController.selected.person.nameWithTitle}" ></h:outputLabel>

                                                <br/>
                                                <strong><i class="fas fa-venus-mars mr-1"></i> Sex :</strong>


                                                <h:outputLabel value="#{clientController.selected.person.sex.name}" ></h:outputLabel>

                                                <br/>
                                                <strong><i class="fab fa-pagelines mr-1"></i> Age :</strong>

                                                <h:outputLabel value="#{clientController.selected.person.age}" ></h:outputLabel>

                                                <br/>
                                                <strong><i class="fas fa-birthday-cake mr-1"></i> DOB :</strong>

                                                <h:outputLabel value="#{clientController.selected.person.dateOfBirth}" >
                                                    <f:convertDateTime pattern="dd MMMM yyyy" ></f:convertDateTime>
                                                </h:outputLabel>
                                                <br/>

                                                <strong><i class="fas fa-mobile-alt mr-1"></i> Mobile No. :</strong>


                                                <h:outputLabel value="#{clientController.selected.person.phone1}" ></h:outputLabel>


                                                <br/>
                                                <strong><i class="fas fa-phone-square-alt mr-1"></i> Tele No. :</strong>

                                                <h:outputLabel value="#{clientController.selected.person.phone2}" ></h:outputLabel>

                                                <br/>
                                                <strong><i class="fas fa-map-marker-alt mr-1"></i> Address</strong>

                                                <p class="text-muted">

                                                    <h:outputLabel value="#{clientController.selected.person.address}" ></h:outputLabel>


                                                </p>

                                                <br/>



                                            </div>
                                            <!-- /.card-body -->
                                        </div>
                                        <!-- /.card -->
                                    </div>
                                    <!-- /.col -->
                                    <div class="col-md-9">
                                        <div class="card">
                                            <div class="card-header p-2">
                                                <ul class="nav nav-pills">
                                                    <li class="nav-item"><a class="nav-link active" href="#summary" data-toggle="tab">Summary</a></li>
                                                    <li class="nav-item"><a class="nav-link" href="#clinics" data-toggle="tab">Clinics</a></li>
                                                    <li class="nav-item"><a class="nav-link" href="#medications" data-toggle="tab">Medications</a></li>
                                                    <li class="nav-item"><a class="nav-link" href="#admissions" data-toggle="tab">Admissions</a></li>
                                                    <li class="nav-item"><a class="nav-link" href="#opd" data-toggle="tab">OPD </a></li>
                                                </ul>
                                            </div><!-- /.card-header -->
                                            <div class="card-body">
                                                <div class="tab-content">
                                                    <div class="active tab-pane" id="summary">

                                                        <div class="row">

                                                            <div class="col-lg-6 col-12">
                                                                <div class="small-box bg-info">
                                                                    <div class="inner">
                                                                        <h4>Allergies</h4>

                                                                        <ul>
                                                                            <ui:repeat value="#{clientEncounterComponentFormSetController.fillClientValues(clientController.selected, 'client_drug_allergy')}"
                                                                                       var="a" >
                                                                                <li>${a.item.name}</li>
                                                                            </ui:repeat>

                                                                            <li>Paracetamol</li>
                                                                        </ul>

                                                                    </div>
                                                                    <div class="icon">
                                                                        <i class="fas fa-allergies"></i>
                                                                    </div>
                                                                    <a href="#" class="small-box-footer">Add New <i class="fas fa-arrow-circle-right"></i></a>
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-6 col-12">
                                                                <div class="small-box bg-info">
                                                                    <div class="inner">
                                                                        <h4>Recent Clinic visits</h4>

                                                                        <ul>
                                                                            <li>2019-08-11 </li>
                                                                            <li>2019-05-21</li>
                                                                            <li>2019-02-11</li>
                                                                        </ul>







                                                                    </div>
                                                                    <div class="icon">
                                                                        <i class="fas fa-clinic-medical"></i>
                                                                    </div>
                                                                    <a href="#" class="small-box-footer">Add New <i class="fas fa-arrow-circle-right"></i></a>
                                                                </div>
                                                            </div>
                                                        </div> 
                                                        <div class="row">

                                                            <div class="col-lg-6 col-12">
                                                                <div class="small-box bg-info">
                                                                    <div class="inner">
                                                                        <h4>Past Surgical Hx</h4>

                                                                        <p>No over 35 Screend and <br/>Registered</p>
                                                                        <div class="icon">
                                                                            <i class="fas fa-clinic-medical"></i>
                                                                        </div>
                                                                    </div>

                                                                    <a href="#" class="small-box-footer">Add New <i class="fas fa-arrow-circle-right"></i></a>
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-6 col-12">
                                                                <div class="small-box bg-info">
                                                                    <div class="inner">
                                                                        <h4>Past OPD visit.</h4>

                                                                        <p>No over 35 Screend and <br/>Registered</p>
                                                                    </div>
                                                                    <div class="icon">
                                                                        <i class="fas fa-clinic-medical"></i>
                                                                    </div>
                                                                    <a href="#" class="small-box-footer">Add New <i class="fas fa-arrow-circle-right"></i></a>
                                                                </div>
                                                            </div>
                                                        </div>

                                                        <div class="row">

                                                            <div class="col-lg-6 col-12">
                                                                <div class="small-box bg-info">
                                                                    <div class="inner">
                                                                        <h4>CVD Risk Score</h4>

                                                                        <p>No over 35 Screend and <br/>Registered</p>
                                                                    </div>
                                                                    <div class="icon">
                                                                        <i class="fas fa-procedures"></i>
                                                                    </div>
                                                                    <a href="#" class="small-box-footer">Add New <i class="fas fa-arrow-circle-right"></i></a>
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-6 col-12">
                                                                <div class="small-box bg-info">
                                                                    <div class="inner">
                                                                        <h4>Medications list</h4>

                                                                        <p>No over 35 Screend <br/>Registered</p>
                                                                    </div>
                                                                    <div class="icon">
                                                                        <i class="fas fa-tablets"></i>
                                                                    </div>
                                                                    <a href="#" class="small-box-footer">Add New <i class="fas fa-arrow-circle-right"></i></a>
                                                                </div>
                                                            </div>




                                                        </div>
                                                        <a class="btn btn-info btn-sm" href="#">
                                                            <i class="fas fa-pencil-alt">
                                                            </i>
                                                            Complete Summary
                                                        </a>
                                                    </div>
                                                    <!-- /.tab-pane -->
                                                    <div class="tab-pane" id="clinics">

                                                        <div class="card card-primary">
                                                            <div class="card-header">
                                                                <h3 class="card-title">Clinic Enrolement</h3>
                                                            </div>
                                                            <!-- /.card-header -->
                                                            <div class="card-body">
                                                            </div>
                                                        </div>
                                                        <div class="card card-primary">
                                                            <div class="card-header">
                                                                <h3 class="card-title">Present Clinics</h3>
                                                            </div>
                                                            <!-- /.card-header -->
                                                            <div class="card-body">
                                                            </div>
                                                        </div>


                                                    </div>
                                                    <!-- /.tab-pane -->

                                                    <div class="tab-pane" id="medications">

                                                    </div>
                                                    <div class="active tab-pane" id="admissions">
                                                        <!-- Post -->

                                                        <!-- /.post -->

                                                        <!-- Post -->

                                                        <!-- /.post -->
                                                    </div>
                                                    <div class="active tab-pane" id="opd">
                                                        <!-- Post -->

                                                        <!-- /.post -->

                                                        <!-- Post -->

                                                        <!-- /.post -->
                                                    </div>
                                                    <!-- /.tab-pane -->
                                                </div>
                                                <!-- /.tab-content -->
                                            </div><!-- /.card-body -->
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </section>
                        <!-- /.content -->
                    </div>




                </h:panelGroup>



                <p:panel style="height: 100%;" rendered="#{clientController.selected ne null}">
                    <f:facet name="header" >
                        <p:outputLabel value="#{clientController.selected.person.nameWithTitle}" ></p:outputLabel>
                        <p:spacer height="0" width="10" ></p:spacer>
                        <p:outputLabel value="#{clientController.selected.person.age}" ></p:outputLabel>
                    </f:facet>

                    <p:panelGrid styleClass="alignTop">

                        <p:row >

                            <p:column  >

                                <h:form>

                                    <p:panel style="text-align: center;">

                                        <f:facet name="header" >
                                            <p:outputLabel value="Demographic Details" style="float: left;" ></p:outputLabel>
                                            <p:commandLink value="Edit" ajax="false" action="client" style="float: right;" ></p:commandLink>
                                        </f:facet>

                                        <p:graphicImage  rendered="#{clientController.selected.person.sex.name eq 'Male'}"
                                                         library="image" name="male.jpg" style="width: 300px; height: 300px; margin: auto;" ></p:graphicImage>

                                        <p:graphicImage  rendered="#{clientController.selected.person.sex.name eq 'Female'}"
                                                         library="image" name="female.png" style="width: 300px; height: 300px; margin: auto;" ></p:graphicImage>


                                        <p:panelGrid columns="2" >




                                            <p:outputLabel value="Name:" for="name" />
                                            <p:outputLabel id="name" value="#{clientController.selected.person.nameWithTitle}" title="Name" />

                                            <p:outputLabel value="Sex:" for="sex" />
                                            <p:outputLabel id="sex"  value="#{clientController.selected.person.sex.name}"  />

                                            <p:outputLabel value="Phn:" for="phn" />
                                            <p:outputLabel id="phn"  value="#{clientController.selected.phn}" title="Phn" />


                                            <p:outputLabel value="Phone:" for="phone1" />
                                            <p:outputLabel id="phone1"  
                                                           value="#{clientController.selected.person.phone1}, #{clientController.selected.person.phone2}" title="Phone1" />


                                            <p:outputLabel value="Area" for="address" />
                                            <p:outputLabel id="address" 
                                                           value="#{clientController.selected.person.gnArea.name}" title="Address" />


                                            <p:outputLabel value="DateOfBirth:" for="dateOfBirth" />
                                            <p:outputLabel id="dateOfBirth" value="#{clientController.selected.person.dateOfBirth}"
                                                           >
                                                <f:convertDateTime pattern="dd MMMM yyyy" ></f:convertDateTime>
                                            </p:outputLabel>

                                            <p:outputLabel value="Age" />
                                            <p:outputLabel value="#{clientController.selected.person.age}"/>


                                        </p:panelGrid>

                                    </p:panel>



                                </h:form>

                            </p:column>

                            <p:column style="width: 80%" >


                                <p:tabView id="tvProfile" activeIndex="#{clientController.profileTabActiveIndex}" >

                                    <p:ajax event="tabChange" process="tvProfile" listener="#{clientController.onTabChange}"/>

                                    <p:tab title="Medications" >
                                        <h:form>
                                            <p:panelGrid columns="1"  style="width: 100%" >
                                                <f:facet name="header" >
                                                    <p:outputLabel value="Current Medications" style="float: left;"></p:outputLabel>
                                                    <p:spacer height="1" width="5" ></p:spacer>
                                                    <p:commandLink ajax="false" value="View Details" action="#"></p:commandLink>
                                                </f:facet>
                                            </p:panelGrid>
                                        </h:form>
                                    </p:tab>

                                    <p:tab title="Admissions" >

                                        <h:form>
                                            <p:panelGrid columns="1" style="width: 100%" >
                                                <f:facet name="header" >
                                                    <p:outputLabel value="Recent Admissions" style="float: left;"></p:outputLabel>
                                                    <p:spacer height="1" width="5" ></p:spacer>
                                                    <p:commandLink ajax="false" value="View Details" action="#"></p:commandLink>
                                                </f:facet>
                                            </p:panelGrid>
                                        </h:form>

                                    </p:tab>                                    

                                    <p:tab title="OPD Visits">
                                        <h:form>
                                            <p:panelGrid columns="1" style="width: 100%" >
                                                <f:facet name="header" >
                                                    <p:outputLabel value="Recent OPD Visits" style="float: left;"></p:outputLabel>
                                                    <p:spacer height="1" width="5" ></p:spacer>
                                                    <p:commandLink ajax="false" value="View Details" action="#"></p:commandLink>
                                                </f:facet>
                                            </p:panelGrid>
                                        </h:form>
                                    </p:tab>

                                    <p:tab title="Clinic Visits" >
                                        <h:form>
                                            <p:panelGrid columns="1" style="width: 100%" >
                                                <f:facet name="header" >
                                                    <p:outputLabel value="Clinic Visits" style="float: left;"></p:outputLabel>
                                                    <p:spacer height="1" width="5" ></p:spacer>
                                                    <p:commandLink ajax="false" value="View Details" action="#"></p:commandLink>
                                                </f:facet>

                                                <p:dataTable value="#{clientEncounterComponentFormSetController.fillLastFiveCompletedEncountersFormSets('Clinic_Visit') }" 
                                                             var="cv"
                                                             >
                                                    <f:facet name="header" >
                                                        <p:outputLabel value="Recent Completed Visits" ></p:outputLabel>
                                                    </f:facet>
                                                    <p:column headerText="Date" >
                                                        <p:outputLabel value="#{cv.encounter.encounterDate}" >
                                                            <f:convertDateTime pattern="dd MMMM yyyy" ></f:convertDateTime>
                                                        </p:outputLabel>
                                                    </p:column>
                                                    <p:column headerText="Visit" >
                                                        <p:commandLink value="#{cv.name}" ajax="false" 
                                                                       action="#{clientEncounterComponentFormSetController.toViewFormset()}" >
                                                            <f:setPropertyActionListener value="#{cv}" target="#{clientEncounterComponentFormSetController.selected}" ></f:setPropertyActionListener>
                                                        </p:commandLink>
                                                    </p:column>
                                                    <p:column headerText="Clinic" >
                                                        <p:outputLabel value="#{cv.institution.name}" >
                                                        </p:outputLabel>
                                                    </p:column>
                                                </p:dataTable>


                                                <p:dataTable value="#{clientEncounterComponentFormSetController.filluncompletedEncountersFormSets('Clinic_Visit')}" 
                                                             var="cv"
                                                             >

                                                    <f:facet name="header">
                                                        <p:outputLabel value="Ongoing Visits" ></p:outputLabel>
                                                    </f:facet>

                                                    <p:column headerText="Date" >
                                                        <p:outputLabel value="#{cv.encounter.encounterDate}" >
                                                            <f:convertDateTime pattern="dd MMMM yyyy hh:mm s" ></f:convertDateTime>
                                                        </p:outputLabel>
                                                    </p:column>
                                                    <p:column headerText="Visit" >
                                                        <p:commandLink value="#{cv.name}" ajax="false" 
                                                                       action="#{clientEncounterComponentFormSetController.toViewFormset()}" >
                                                            <f:setPropertyActionListener value="#{cv}" target="#{clientEncounterComponentFormSetController.selected}" ></f:setPropertyActionListener>
                                                        </p:commandLink>
                                                    </p:column>
                                                    <p:column headerText="Clinic" >
                                                        <p:outputLabel value="#{cv.institution.name}" >
                                                        </p:outputLabel>
                                                    </p:column>
                                                </p:dataTable>

                                            </p:panelGrid>
                                        </h:form>
                                    </p:tab>

                                    <p:tab title="Test Results" >
                                        <h:form>
                                            <p:panelGrid columns="1" style="width: 100%" >
                                                <f:facet name="header" >
                                                    <p:outputLabel value="Recent Tests" style="float: left;"></p:outputLabel>
                                                    <p:spacer height="1" width="5" ></p:spacer>
                                                    <p:commandLink ajax="false" value="View Details" action="#"></p:commandLink>
                                                </f:facet>
                                            </p:panelGrid>
                                        </h:form>
                                    </p:tab>

                                    <p:tab title="Clinics" >
                                        <h:form >


                                            <p:dataTable id="tblClinics" value="#{clientController.selectedClientsClinics}" var="chlce" >
                                                <f:facet name="header" >
                                                    <p:outputLabel value="Current Clinics" ></p:outputLabel>
                                                </f:facet>
                                                <p:column headerText="Clinic" >
                                                    <p:outputLabel value="#{chlce.institution.name}" ></p:outputLabel>
                                                </p:column>
                                                <p:column headerText="Number" >
                                                    <p:outputLabel value="#{chlce.encounterNumber}" ></p:outputLabel>
                                                </p:column>
                                                <p:column headerText="New Encounter" >
                                                    <h:dataTable value="#{designComponentFormSetController.getClinicFormSets(chlce.institution)}"
                                                                 var="cfs"  border="0" >
                                                        <h:column >
                                                            <p:commandLink id="btnNewFormset" value="New #{cfs.name}" process="@this" update="@all"
                                                                           action="#{clientEncounterComponentFormSetController.createAndNavigateToClinicalEncounterComponentFormSetFromDesignComponentFormSetForClinicVisit(cfs)}" >
                                                            </p:commandLink>
                                                            <p:blockUI block=":#{p:component('tblClinics')}" trigger="btnNewFormset" >
                                                                LOADING Patient data.<br/>
                                                                Please wait.<br/>
                                                                <p:graphicImage library="image" name="loading.gif" ></p:graphicImage>
                                                            </p:blockUI>
                                                        </h:column>
                                                    </h:dataTable>
                                                </p:column>
                                            </p:dataTable>
                                        </h:form>
                                    </p:tab>

                                    <p:tab title="Actions">
                                        <h:form >
                                            <p:panelGrid  columns="3" style="width: 100%" >
                                                <f:facet name="header">
                                                    <p:outputLabel value="Enroll in an Clinic" ></p:outputLabel>
                                                </f:facet>

                                                <p:outputLabel value="Clinic" ></p:outputLabel>

                                                <p:selectOneMenu value="#{clientController.selectedClinic}" >
                                                    <f:selectItems value="#{institutionController.myClinics}" 
                                                                   var="shlc" itemValue="#{shlc}" itemLabel="#{shlc.name}"></f:selectItems>
                                                </p:selectOneMenu>

                                                <p:commandButton action="#{institutionController.refreshMyInstitutions()}" ajax="false" 
                                                                 icon="ui-icon-arrowrefresh-1-n" ></p:commandButton>

                                                <p:spacer></p:spacer>
                                                <p:commandButton value="Enroll" ajax="false" action="#{clientController.enrollInClinic()}" ></p:commandButton>
                                                <p:spacer></p:spacer>

                                            </p:panelGrid>
                                        </h:form>
                                    </p:tab>



                                </p:tabView>


                            </p:column>

                        </p:row>

                    </p:panelGrid>


                </p:panel>




            </ui:define>

        </ui:composition>

    </body>
</html>
